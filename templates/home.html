{% extends 'base.html' %}
{% load humanize %}


{% block content %}
<!-- Load More Spinner -->
<div id="loader"></div>
<div>
    <h1>Testing</h1>
</div>
    <!----CAROUSEL---->
    <div class="bd-example">
        <div id="carousel" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
                <li data-target="#carousel" data-slide-to="0" class="active"></li>
                <li data-target="#carousel" data-slide-to="1"></li>
                <li data-target="#carousel" data-slide-to="2"></li>
                <li data-target="#carousel" data-slide-to="3"></li>
                <li data-target="#carousel" data-slide-to="4"></li>
                <li data-target="#carousel" data-slide-to="5"></li>
            </ol>
            <div class="carousel-inner">
                {% for banner in banners %}
                    <div class="carousel-item {% if forloop.counter0 == 0 %} active {% endif %}">
                        <img src=" {{ banner.image.url }}" class="d-block w-100" alt="...">
                    </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
                <span hidden class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
                <span hidden class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
    <!----END CAROUSEL---->

    <!--Section Start-->
    {% for section in sections %}
        {% if section.id == 1 %}
            <div class="container">
                <div class="row m-4">
                    <div class="max-auto col-sm-6" data-aos="zoom-in">
                        <div class="display-4 font-weight-bold">{{ section.title }}</div>
                        <p class="lead">{{ section.sub_title }}</p>
                        <hr class="my-4">
                        <h2 class="font-weight-bold">{{ section.description }}</h2>
                        <a class="btn btn-lg border sweep-to-right" href="/">Learn More</a>
                    </div>
                    <div class="mx-auto col-sm-6" data-aos="fade-left" data-aos-offset="300"
                         data-aos-easing="ease-in-sine">
                        <img src="{{ section.image.url }}" alt="">
                    </div>
                </div>
            </div>
        {% elif section.id == 2 %}
            <div class="jumbotron p-1">
                <div class="container">
                    <div class="row m-2">
                        <div class="mx-auto col-sm-6 m-3" data-aos="fade-right" data-aos-offset="300"
                             data-aos-easing="ease-in-sine">
                            <img src="{{ section.image.url }}" alt="">
                        </div>
                        <div class="max-auto col-sm-6" data-aos="zoom-in">
                            <div class="display-4 font-weight-bold">{{ section.title }}</div>
                            <p class="lead">{{ section.sub_title }}</p>
                            <hr class="my-4">
                            <h2 class="font-weight-bold">{{ section.description }}</h2>
                            <a class="btn btn-lg border sweep-to-right" href="/">Learn More</a>
                        </div>
                    </div>
                </div>
            </div>
        {% elif section.id == 3 %}
            <div class="container">
                <div class="row m-5">
                    <div class="max-auto col-sm-6" data-aos="zoom-in">
                        <div class="display-4 font-weight-bold">{{ section.title }}</div>
                        <p class="lead">{{ section.sub_title }}</p>
                        <hr class="my-4">
                        <h2 class="font-weight-bold">{{ section.description }}</h2>
                        <a class="btn btn-lg border sweep-to-right" href="/">Learn More</a>
                    </div>
                    <div class="mx-auto col-sm-6" data-aos="fade-left" data-aos-offset="300"
                         data-aos-easing="ease-in-sine">
                        <img src="{{ section.image.url }}" alt="">
                    </div>
                </div>
            </div>
        {% elif section.id == 4 %}
            <div class="jumbotron p-1">
                <div class="container">
                    <div class="row m-2">
                        <div class="mx-auto col-sm-4">
                            <img src="{{ section.image.url }}" alt="">
                        </div>
                        <div class="max-auto col-sm-6" data-aos="fade-left" data-aos-offset="300"
                             data-aos-easing="ease-in-sine">
                            <div class="display-4 font-weight-bold">{{ section.title }}</div>
                            <p class="lead">{{ section.sub_title }}</p>
                            <hr class="my-4">
                            <h2 class="font-weight-bold">{{ section.description }}</h2>
                            <a class="btn btn-lg border sweep-to-right" href="/">Learn More</a>
                        </div>
                    </div>
                </div>
            </div>
        {% elif section.id == 5 %}
            <div class="container">
                <div class="align-center">
                    <div class="mx-auto" data-aos="zoom-in" data-aos-offset="300"
                         data-aos-easing="ease-in-sine">
                        <img src="{{ section.image.url }}" alt="">
                    </div>
                </div>
                <div class="m-5 p-3 text-center" data-aos="zoom-in">
                    <div class="display-4 font-weight-bold">{{ section.title }}</div>
                    <p class="lead">{{ section.sub_title }}</p>
                    <hr class="my-4">
                    <a class="btn btn-lg border sweep-to-right" href="/">Learn More</a>
                </div>
            </div>
        {% elif section.id == 6 %}
            <div class="jumbotron p-1">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-6 col-lg-5" data-aos="fade-right" data-aos-offset="300"
                             data-aos-easing="ease-in-sine">
                            <img src="{{ section.image.url }}" alt="">
                        </div>
                        <div class="max-auto col-sm-6" data-aos="zoom-in">
                            <div class="display-4 font-weight-bold">{{ section.title }}</div>
                            <p class="lead">{{ section.sub_title }}</p>
                            <hr class="my-4">
                            <h2 class="font-weight-bold">{{ section.description }}</h2>
                            <a class="btn btn-lg border sweep-to-right" href="/">Learn More</a>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    {% endfor %}
    <!--Section End-->

    <!-- Brand Image Slider -->
<div class="container">
    <div uk-slider="autoplay: true; autoplay-interval: 3000; pause-on-hover: true; center: true; animation: slide;">
        <div class="uk-position-relative">
            <div class="uk-slider-container uk-light">
                <ul class="uk-slider-items uk-child-width-1-2 uk-child-width-1-4@m uk-grid">
                    {% for brand in brands %}
                        <li class="brand-size">
                            <img src="{{ brand.image.url }}" alt="{{ brand.name }}" class="img-fluid" style="max-height: 80px; object-fit: contain;">
                        </li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Left/Right Nav for Desktop -->
            <a class="uk-position-center-left-out uk-position-small uk-visible@s" href="#" uk-slidenav-previous uk-slider-item="previous"></a>
            <a class="uk-position-center-right-out uk-position-small uk-visible@s" href="#" uk-slidenav-next uk-slider-item="next"></a>

            <!-- Left/Right Nav for Mobile -->
            <a class="uk-position-center-left uk-position-small uk-hidden@s" href="#" uk-slidenav-previous uk-slider-item="previous"></a>
            <a class="uk-position-center-right uk-position-small uk-hidden@s" href="#" uk-slidenav-next uk-slider-item="next"></a>
        </div>

        <!-- Dot Navigation -->
        <ul class="uk-slider-nav uk-dotnav uk-flex-center uk-margin"></ul>
    </div>
</div>


<!-- Featured Products -->
<h1 class="mb-5 text-center uk-text-bolder">Featured Products</h1>
<div class="container">
    <div class="row" id="product-container">
        {% for product in products %}
            <div class="col-sm-6 col-lg-3 mb-5 product-card">
                <div class="uk-text-center">
                    <div class="uk-inline-clip uk-transition-toggle" tabindex="0">
                        <div class="p-4">
                            <img src="{{ product.image.url }}" alt="Product Image">
                        </div>
                        <div class="m-0">
                            <span>{{ product.name }}</span><br>
                            <span>{{ product.specs }}</span><br>
                            <span class="uk-text-bolder">Nrs. {{ product.price|intcomma }}</span>
                        </div>
                        <div class="uk-transition-slide-bottom uk-position-bottom uk-overlay uk-overlay-default">
                            <a href="/product-details/?productsId={{ product.id }}"
                               class="btn mx-auto border sweep-to-right" style="background-color: #cccccc">
                                Choose Specs
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="text-center">
        <button id="load-more-btn" class="btn btn-lg border sweep-to-right">Load More</button>
        <!-- Load More Button -->
    </div>
</div>

<!-- Load More Script -->
<script>
    let offset = {{ initial_limit }};
    const limit = 4;
    const btn = document.getElementById('load-more-btn');
    const loader = document.getElementById('loader');

    btn.addEventListener('click', function () {
        btn.style.display = 'none';
        loader.style.display = 'block';

        fetch(`?offset=${offset}&limit=${limit}`, {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            const products = data.products;
            loader.style.display = 'none';

            if (!products || products.length === 0) {
                btn.style.display = 'none';
                return;
            }

            const parsedProducts = JSON.parse(products);
            parsedProducts.forEach(item => {
                const fields = item.fields;
                const productHTML = `
                    <div class="col-sm-6 col-lg-3 mb-5 product-card fade-in">
                        <div class="uk-text-center">
                            <div class="uk-inline-clip uk-transition-toggle" tabindex="0">
                                <div class="p-4">
                                    <img src="{{ media_url }}${fields.image}" alt="Product Image">
                                </div>
                                <div class="m-0">
                                    <span>${fields.name}</span><br>
                                    <span>${fields.specs}</span><br>
                                    <span class="uk-text-bolder">Nrs. ${parseInt(fields.price).toLocaleString()}</span>
                                </div>
                                <div class="uk-transition-slide-bottom uk-position-bottom uk-overlay uk-overlay-default">
                                    <a href="/product-details/?productsId=${item.pk}"
                                       class="btn mx-auto border sweep-to-right" style="background-color: #cccccc">
                                        Choose Specs
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>`;
                document.getElementById('product-container').insertAdjacentHTML('beforeend', productHTML);
            });

            offset += limit;
            btn.style.display = 'inline-block';
        });
    });
</script>


{% endblock %}

